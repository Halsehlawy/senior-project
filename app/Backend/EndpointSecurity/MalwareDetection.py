import subprocess

def run_clamav_scan(scan_type="quick", target_path="D:\\"):
    """
    Run a ClamAV scan (quick or full) on a specified path.

    :param scan_type: "quick" for a quick scan, "full" for a full scan.
    :param target_path: The directory or file to scan. Default is "D:/".
    :return: Scan result as a string.
    """
    # Specify the full path to clamscan.exe
    clamscan_path = r"C:\Program Files\ClamAV\clamscan.exe"

    # Determine the scan command based on the scan type
    if scan_type == "quick":
        command = [clamscan_path, "--infected", "--recursive", "--quiet", target_path]
    elif scan_type == "full":
        command = [clamscan_path, "--infected", "--recursive", "--quiet", "--scan-archive=yes", target_path]
    else:
        return "Invalid scan type. Use 'quick' or 'full'."

    try:
        # Run the ClamAV scan
        result = subprocess.run(command, capture_output=True, text=True)
        
        # Check the scan result
        if result.returncode == 0:
            return "No threats detected."
        elif result.returncode == 1:
            return "Threats detected!\n" + result.stdout
        else:
            return f"Error during scan: {result.stderr}"
    except FileNotFoundError:
        return "ClamAV is not installed or not in PATH."

# Example usage
if __name__ == "__main__":
    # Quick scan on the D:/ drive
    print("Running quick scan...")
    print(run_clamav_scan(scan_type="quick", target_path="D:\\"))

    # Full scan on the D:/ drive
    print("Running full scan...")
    print(run_clamav_scan(scan_type="full", target_path="D:\\"))